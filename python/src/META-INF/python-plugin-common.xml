<idea-plugin version="2">

  <extensions defaultExtensionNs="com.intellij">
    <errorHandler implementation="com.intellij.diagnostic.ITNReporter"/>
    <fileTypeFactory implementation="com.jetbrains.python.PythonFileTypeFactory"/>
    <lang.syntaxHighlighterFactory key="Python" implementationClass="com.jetbrains.python.PySyntaxHighlighterFactory"/>
    <lang.braceMatcher language="Python" implementationClass="com.jetbrains.python.PyBraceMatcher"/>
    <lang.parserDefinition language="Python" implementationClass="com.jetbrains.python.PythonParserDefinition"/>
    <lang.commenter language="Python" implementationClass="com.jetbrains.python.PythonCommenter"/>
    <lang.foldingBuilder language="Python" implementationClass="com.jetbrains.python.PythonFoldingBuilder"/>
    <lang.foldingBuilder language="DjangoTemplate" implementationClass="com.jetbrains.django.editor.DjangoTemplateFoldingBuilder"/>
    <lang.findUsagesProvider language="Python" implementationClass="com.jetbrains.python.findUsages.PythonFindUsagesProvider"/>
    <lang.formatter language="Python" implementationClass="com.jetbrains.python.PythonFormattingModelBuilder"/>
    <lang.namesValidator language="Python" implementationClass="com.jetbrains.python.refactoring.PythonNamesValidator"/>
    <lang.surroundDescriptor language="Python" implementationClass="com.jetbrains.python.refactoring.surround.PyStatementSurroundDescriptor"/>
    <lang.surroundDescriptor language="Python" implementationClass="com.jetbrains.python.refactoring.surround.PyExpressionSurroundDescriptor"/>
    <lang.psiStructureViewFactory language="Python" implementationClass="com.jetbrains.python.structureView.PyStructureViewFactory"/>
    <lang.documentationProvider language="Python" implementationClass="com.jetbrains.python.PythonDocumentationProvider"/>
    <lang.documentationProvider language="Python" implementationClass="com.jetbrains.python.console.PydevDocumentationProvider"/>
    <annotator language="Python" implementationClass="com.jetbrains.python.validation.PyAnnotatingVisitor"/>
    <annotator language="Python" implementationClass="com.jetbrains.python.validation.PyDumbAwareAnnotator"/>
    <backspaceHandlerDelegate implementation="com.jetbrains.python.editor.PythonBackspaceHandler"/>
    <quoteHandler fileType="Python" className="com.jetbrains.python.editor.PythonQuoteHandler"/>
    <sdkType implementation="com.jetbrains.python.sdk.PythonSdkType"/>
    <gotoClassContributor implementation="com.jetbrains.python.PyGotoClassContributor"/>
    <gotoSymbolContributor implementation="com.jetbrains.python.PyGotoSymbolContributor"/>
    <codeInsight.parameterInfo language="Python" implementationClass="com.jetbrains.python.PyParameterInfoHandler"/>
    <colorSettingsPage implementation="com.jetbrains.python.PythonColorsPage"/>
    <extendWordSelectionHandler implementation="com.jetbrains.python.editor.selectWord.PyWordSelectionHandler"/>
    <extendWordSelectionHandler implementation="com.jetbrains.python.editor.selectWord.PyStatementSelectionHandler"/>
    <completion.contributor language="Python" implementationClass="com.jetbrains.python.codeInsight.PyKeywordCompletionContributor"/>
    <completion.contributor language="Python" implementationClass="com.jetbrains.python.codeInsight.PySpecialMethodNamesCompletionContributor"/>
    <lang.tokenSeparatorGenerator language="Python" implementationClass="com.jetbrains.python.PyTokenSeparatorGenerator"/>
    <lang.elementManipulator forClass="com.jetbrains.python.psi.PyReferenceExpression" implementationClass="com.jetbrains.python.psi.impl.PyReferenceExpressionManipulator"/>
    <!--
    <com.intellij.inspectionToolsFactory implementation="com.jetbrains.python.inspections.PythonPyInspectionToolProvider"/>
    -->

    <projectService serviceInterface="com.jetbrains.python.psi.PyElementGenerator"
                    serviceImplementation="com.jetbrains.python.psi.impl.PyElementGeneratorImpl"/>

    <typedHandler implementation="com.jetbrains.python.codeInsight.KeywordTypedHandler" id="pyCommaAfterKwd"/>
    <typedHandler implementation="com.jetbrains.django.codeInsight.InterpolationTypedHandler" id="pyDjangoBraceInterpolation"/>
    <typedHandler implementation="com.jetbrains.python.editor.ColonTypedHandler" id="pyColonUnindent"/>

    <stubIndex implementation="com.jetbrains.python.psi.stubs.PyClassNameIndex"/>
    <stubIndex implementation="com.jetbrains.python.psi.stubs.PyFunctionNameIndex"/>
    <stubIndex implementation="com.jetbrains.python.psi.stubs.PySuperClassIndex"/>

    <fileTypeIndentOptionsProvider implementation="com.jetbrains.python.formatter.PyIndentOptionsProvider"/>

    <!-- Run/Debug -->
    <configurationType implementation="com.jetbrains.python.run.PythonConfigurationType"/>
    <programRunner implementation="com.jetbrains.python.run.PythonRunner"/>
    <programRunner implementation="com.jetbrains.python.debugger.PyDebugRunner"/>
    <configurationProducer implementation="com.jetbrains.python.run.PythonRunConfigurationProducer"/>
    <xdebugger.breakpointType implementation="com.jetbrains.python.debugger.PyLineBreakpointType"/>

    <configurationType implementation="com.jetbrains.python.testing.PythonUnitTestConfigurationType"/>
    <testSrcLocator implementation="com.jetbrains.python.testing.PythonUnitTestTestIdUrlProvider"/>

    <configurationType implementation="com.jetbrains.python.testing.pytest.PyTestRunConfigurationType"/>

    <applicationService serviceInterface="com.jetbrains.python.JythonManager"
                        serviceImplementation="com.jetbrains.python.JythonManager"/>

    <referenceImporter implementation="com.jetbrains.python.validation.PythonReferenceImporter"/>
    <codeInsight.lineMarkerProvider language="Python" implementationClass="com.jetbrains.python.codeInsight.PyLineMarkerProvider"/>
    <definitionsSearch implementation="com.jetbrains.python.psi.search.PyDefinitionsSearch"/>
    <gotoTargetRendererProvider implementation="com.jetbrains.python.codeInsight.PyGotoTargetRendererProvider"/>

    <typeHierarchyProvider language="Python" implementationClass="com.jetbrains.python.hierarchy.PyTypeHierachyProvider"/>
    <highlightUsagesHandlerFactory implementation="com.jetbrains.python.codeInsight.highlighting.PyHighlightExitPointsHandlerFactory"/>
    <intentionAction factoryClass="com.jetbrains.python.PyExtensionFactory"
                     factoryArgument="intentions/PyDemorganIntention.py">
      <className>PyDemorganIntention</className>
      <category>Python</category>
      <descriptionDirectoryName>PyDemorganIntention</descriptionDirectoryName>
    </intentionAction>

    <intentionAction>
      <className>com.jetbrains.python.codeInsight.intentions.ImportToImportFromIntention</className>
      <category>Python</category>
      <descriptionDirectoryName>ImportToImportFromIntention</descriptionDirectoryName>
    </intentionAction>

    <intentionAction>
      <className>com.jetbrains.python.codeInsight.intentions.ImportFromToImportIntention</className>
      <category>Python</category>
      <descriptionDirectoryName>ImportFromToImportIntention</descriptionDirectoryName>
    </intentionAction>

    <intentionAction>
      <className>com.jetbrains.python.codeInsight.intentions.ImportToggleAliasIntention</className>
      <category>Python</category>
      <descriptionDirectoryName>ImportToggleAliasIntention</descriptionDirectoryName>
    </intentionAction>

    <intentionAction>
      <className>com.jetbrains.python.codeInsight.intentions.PySplitIfIntention</className>
      <category>Python</category>
      <descriptionDirectoryName>PySplitIfIntention</descriptionDirectoryName>
    </intentionAction>

    <intentionAction>
      <className>com.jetbrains.python.codeInsight.intentions.PyNegateComparisonIntention</className>
      <category>Python</category>
      <descriptionDirectoryName>PyNegateComparisonIntention</descriptionDirectoryName>
    </intentionAction>

    <intentionAction>
      <className>com.jetbrains.python.codeInsight.intentions.PyStringConcatenationToFormatIntention</className>
      <category>Python</category>
      <descriptionDirectoryName>PyStringConcatenationToFormatIntention</descriptionDirectoryName>
    </intentionAction>

    <intentionAction>
      <className>com.jetbrains.python.codeInsight.intentions.ConvertFormatOperatorToMethodIntention</className>
      <category>Python</category>
      <descriptionDirectoryName>ConvertFormatOperatorToMethodIntention</descriptionDirectoryName>
    </intentionAction>

    <intentionAction>
      <className>com.jetbrains.python.codeInsight.intentions.PyFlipComparisonIntention</className>
      <category>Python</category>
      <descriptionDirectoryName>PyFlipComparisonIntention</descriptionDirectoryName>
    </intentionAction>

    <stubElementTypeHolder class="com.jetbrains.python.PyElementTypes"/>
    <inspectionToolProvider implementation="com.jetbrains.python.inspections.PythonInspectionToolProvider"/>

    <liveTemplateContext implementation="com.jetbrains.python.codeInsight.PythonTemplateContextType"/>
    <liveTemplateMacro implementation="com.jetbrains.python.codeInsight.CollectionElementNameMacro"/>

    <codeInsight.overrideMethod language="Python" implementationClass="com.jetbrains.python.codeInsight.override.PyOverrideMethodsHandler"/>
    <lang.refactoringSupport language="Python" implementationClass="com.jetbrains.python.refactoring.RefactoringProvider"/>
    <lang.refactoringSupport.classMembersRefactoringSupport language="Python" implementationClass="com.jetbrains.python.refactoring.classes.PyClassMembersRefactoringSupport"/>
    <inlineActionHandler implementation="com.jetbrains.python.refactoring.inline.PyInlineLocalHandler"/>
    <codeInsight.gotoSuper language="Python" implementationClass="com.jetbrains.python.codeInsight.PyGotoSuperHandler"/>
    <gotoDeclarationHandler implementation="com.jetbrains.python.codeInsight.PyBreakContinueGotoProvider" order="FIRST"/>

    <filePropertyPusher implementation="com.jetbrains.python.psi.impl.PythonLanguageLevelPusher"/>

    <elementDescriptionProvider implementation="com.jetbrains.python.findUsages.PyElementDescriptionProvider"/>
    <fileStructureGroupRuleProvider implementation="com.jetbrains.python.findUsages.PyFunctionGroupingRuleProvider" id="py-function"/>
    <usageTypeProvider implementation="com.jetbrains.python.findUsages.PyUsageTypeProvider"/>

    <languageInjector implementation="com.jetbrains.python.codeInsight.PythonRegexpInjector"/>

    <applicationService serviceInterface="com.jetbrains.python.codeInsight.PyCodeInsightSettings"
                        serviceImplementation="com.jetbrains.python.codeInsight.PyCodeInsightSettings"/>
    <autoImportOptionsProvider implementation="com.jetbrains.python.codeInsight.PyAutoImportOptions"/>

    <defaultLiveTemplatesProvider implementation="com.jetbrains.python.codeInsight.PyDefaultLiveTemplatesProvider"/>

    <completion.contributor language="Python" implementationClass="com.jetbrains.python.codeInsight.PyClassNameCompletionContributor"/>

    <referencesSearch implementation="com.jetbrains.python.psi.search.PyInitReferenceSearchExecutor"/>
    <findUsagesHandlerFactory implementation="com.jetbrains.python.findUsages.PyFindUsagesHandlerFactory" id="Python"
                              order="last, before default"/>
    <readWriteAccessDetector implementation="com.jetbrains.python.findUsages.PyReadWriteAccessDetector"/>

    <renamePsiElementProcessor implementation="com.jetbrains.python.refactoring.RenamePyFunctionProcessor" order="last" />

    <!-- Django -->
    <codeInsight.lineMarkerProvider language="Python" implementationClass="com.jetbrains.django.annotator.ViewMethodLineMarkerProvider"/>
    <configurationType implementation="com.jetbrains.django.run.DjangoServerRunConfigurationType"/>
    <configurationType implementation="com.jetbrains.django.testRunner.DjangoTestsConfigurationType"/>

    <lang.substitutor language="XHTML" implementationClass="com.jetbrains.django.lang.template.DjangoTemplateLanguageProvider"/>
    <lang.substitutor language="HTML" implementationClass="com.jetbrains.django.lang.template.DjangoTemplateLanguageProvider"/>
    <lang.substitutor language="XML" implementationClass="com.jetbrains.django.lang.template.DjangoTemplateLanguageProvider"/>

    <lang.parserDefinition language="DjangoTemplate"
                           implementationClass="com.jetbrains.django.lang.template.parsing.DjangoTemplateParserDefinition"/>
    <lang.fileViewProviderFactory language="DjangoTemplate"
                                  implementationClass="com.jetbrains.django.lang.template.DjangoTemplateFileProviderFactory"/>
    <lang.ast.factory language="DjangoTemplate" implementationClass="com.jetbrains.django.lang.template.psi.impl.DjangoASTFactory"/>

    <lang.syntaxHighlighterFactory key="DjangoTemplate"
                                   implementationClass="com.jetbrains.django.lang.template.highlighting.DjangoTemplateHighlighterFactory"/>

    <psi.referenceContributor implementation="com.jetbrains.django.ref.DjangoReferenceContributor"/>

    <inspectionToolProvider implementation="com.jetbrains.django.inspection.DjangoInspectionToolProvider"/>

    <moduleService serviceInterface="com.jetbrains.django.model.TemplateManager"
                   serviceImplementation="com.jetbrains.django.model.TemplateManager"/>

    <facetType implementation="com.jetbrains.django.facet.DjangoFacetType"/>

    <codeInsight.lineMarkerProvider language="DjangoTemplate" implementationClass="com.jetbrains.django.annotator.ViewLineMarkerProvider"/>

    <languageInjector implementation="com.jetbrains.django.codeInsight.DjangoRegexpInjector"/>

    <liveTemplateContext implementation="com.jetbrains.django.lang.template.DjangoTemplateContextType"/>
    <liveTemplateMacro implementation="com.jetbrains.django.lang.template.macros.DjangoVariableMacro"/>
    <liveTemplateMacro implementation="com.jetbrains.django.lang.template.macros.DjangoBlockMacro"/>
    <liveTemplateMacro implementation="com.jetbrains.django.lang.template.macros.DjangoTemplateTagsMacro"/>
    <liveTemplateMacro implementation="com.jetbrains.django.lang.template.macros.DjangoFilterMacro"/>

    <!-- App Engine -->
    <facetType implementation="com.jetbrains.appengine.facet.AppEngineFacetType"/>

    <configurationType implementation="com.jetbrains.appengine.run.AppEngineServerRunConfigurationType"/>

    <lang.parserDefinition language="GQL" implementationClass="com.jetbrains.appengine.lang.gql.parsing.GqlParserDefinition" />
    <multiHostInjector implementation="com.jetbrains.appengine.lang.gql.GqlLanguageInjector"/>
    <lang.syntaxHighlighterFactory key="GQL"
                                     implementationClass="com.jetbrains.appengine.lang.gql.highlighting.GqlHighlighterFactory"/>

    <completion.contributor language="Python" implementationClass="com.jetbrains.appengine.model.ModelAttributeCompletionContributor"/>
    <completion.contributor language="yaml" implementationClass="com.jetbrains.appengine.completion.AppYamlKeyCompletionContributor"/>
    <completion.contributor language="GQL" implementationClass="com.jetbrains.appengine.completion.GqlKeywordCompletionContributor"/>

    <psi.referenceContributor implementation="com.jetbrains.appengine.ref.AppEngineReferenceContributor"/>

    <inspectionToolProvider implementation="com.jetbrains.appengine.inspection.AppEngineInspectionToolProvider"/>
  </extensions>

  <extensionPoints>
    <extensionPoint qualifiedName="Pythonid.importResolver" interface="com.jetbrains.python.psi.impl.PyImportResolver"/>
    <extensionPoint qualifiedName="Pythonid.typeProvider" interface="com.jetbrains.python.psi.impl.PyTypeProvider"/>
    <extensionPoint qualifiedName="Pythonid.pySuperMethodsSearch" interface="com.intellij.util.QueryExecutor"/>
    <extensionPoint qualifiedName="Pythonid.pyClassInheritorsSearch" interface="com.intellij.util.QueryExecutor"/>
    <extensionPoint qualifiedName="Pythonid.pyClassMembersProvider" interface="com.jetbrains.python.psi.types.PyClassMembersProvider"/>
    <extensionPoint qualifiedName="Pythonid.pyOverridingMethodsSearch" interface="com.intellij.util.QueryExecutor"/>
    <extensionPoint qualifiedName="Pythonid.runnableScriptFilter" interface="com.jetbrains.python.run.RunnableScriptFilter"/>
    <extensionPoint qualifiedName="Pythonid.runnableUnitTestFilter" interface="com.jetbrains.python.testing.RunnableUnitTestFilter"/>
    <extensionPoint qualifiedName="Pythonid.unresolvedReferenceQuickFixProvider" interface="com.jetbrains.python.inspections.PyUnresolvedReferenceQuickFixProvider"/>
    <extensionPoint qualifiedName="Pythonid.dumbAnnotator" interface="com.jetbrains.python.validation.PyAnnotator"/>
  </extensionPoints>

  <extensions defaultExtensionNs="Pythonid">
    <pySuperMethodsSearch implementation="com.jetbrains.python.psi.search.PySuperMethodsSearchExecutor"/>
    <pyClassInheritorsSearch implementation="com.jetbrains.python.psi.search.PyClassInheritorsSearchExecutor"/>
    <pyOverridingMethodsSearch implementation="com.jetbrains.python.psi.search.PyOverridingMethodsSearchExecutor"/>
    <runnableScriptFilter implementation="com.jetbrains.python.testing.pytest.PyTestRunnableScriptFilter"/>
    <runnableScriptFilter implementation="com.jetbrains.python.testing.PythonUnitTestRunnableScriptFilter"/>
    <dumbAnnotator implementation="com.jetbrains.python.validation.DocStringAnnotator"/>
    <dumbAnnotator implementation="com.jetbrains.python.validation.PyDefinitionsAnnotator"/>

    <!-- Django -->
    <pyClassMembersProvider implementation="com.jetbrains.django.codeInsight.DjangoClassMembersProvider"/>
    <typeProvider implementation="com.jetbrains.django.codeInsight.DjangoTypeProvider"/>
    <unresolvedReferenceQuickFixProvider implementation="com.jetbrains.django.ref.DjangoViewReferenceQuickFixProvider"/>
    <runnableUnitTestFilter implementation="com.jetbrains.django.testRunner.DjangoUnitTestFilter"/>

    <!-- App Engine -->
    <typeProvider implementation="com.jetbrains.appengine.model.AppEngineTypeProvider"/>
  </extensions>

  <project-components>
    <component>
      <implementation-class>com.jetbrains.python.PythonPsiManager</implementation-class>
    </component>
    <component>
      <implementation-class>com.jetbrains.python.sdk.SkeletonVersionUpdater</implementation-class>
    </component>
  </project-components>

  <actions>
    <action
        id="Devmode.DumpPsi"
        class="com.jetbrains.python.devmode.DumpPsiToClipboardAction"
        text="Dump PSI to clipboard"
        >
      <add-to-group group-id="ToolsMenu" anchor="after" relative-to-action="Macros"/>
    </action>

    <group id="PyTypeHierarchyPopupMenu">
      <reference ref="TypeHierarchyBase.BaseOnThisType"/>
      <reference ref="TypeHierarchy.Class"/>
      <reference ref="TypeHierarchy.Subtypes"/>
      <reference ref="TypeHierarchy.Supertypes"/>
      <separator/>
      <reference ref="EditSource"/>
      <separator/>
      <reference ref="FindUsages"/>
      <reference ref="RefactoringMenu"/>
      <separator/>
      <reference ref="AddToFavorites"/>
      <reference ref="MoveToChangeList"/>
      <separator/>
      <reference ref="RunContextPopupGroup"/>
      <separator/>
      <reference ref="ReformatCode"/>
      <reference ref="OptimizeImports"/>
      <reference ref="$Delete"/>
      <separator/>
      <reference ref="VersionControlsGroup"/>
      <separator/>
      <reference ref="ExternalToolsGroup"/>
      <separator/>
      <reference ref="CompareTwoFiles"/>
      <reference ref="CompareFileWithEditor"/>
    </group>

    <action id="Django.RunManageTaskAction" class="com.jetbrains.django.actions.RunManageTaskAction"
            text="Run manage.py task..."
            description="Runs manage.py task">

      <add-to-group group-id="ToolsMenu" anchor="first"/>
    </action>

    <group text="Google App Engine" popup="true">
      <action id="PythonAppEngine.UploadAppAction" class="com.jetbrains.appengine.action.UpdateAppAction"
              text="Upload App Engine app..."
              description="Uploads App Engine application to google server">

      </action>

      <action id="PythonAppEngine.GetLogsAction" class="com.jetbrains.appengine.action.GetLogsAction"
              text="Get App Engine logs..."
              description="Downloads App Engine logs">
      </action>
      <add-to-group group-id="ToolsMenu" anchor="after" relative-to-action="Django.RunManageTaskAction"/>
    </group>
    <action id="com.jetbrains.python.console.RunPythonConsoleAction"
            class="com.jetbrains.python.console.RunPythonConsoleAction"
            text="Run Python Console..." description="Allows to quickly run Python console">
      <add-to-group group-id="ToolsMenu" anchor="last"/>
    </action>
    <action id="com.jetbrains.django.console.RunDjangoConsoleAction"
            class="com.jetbrains.django.console.RunDjangoConsoleAction"
            text="Run Django Console..." description="Allows to quickly run Django console">
      <add-to-group group-id="ToolsMenu" anchor="last"/>
    </action>
    <action id="Console.Execute" class="com.intellij.openapi.actionSystem.EmptyAction" text="Execute Current Statement"/>
  </actions>
</idea-plugin>
