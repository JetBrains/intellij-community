module(name = "rules_jvm", version = "0.1")

bazel_dep(name = "bazel_worker_api", version = "0.0.4")
bazel_dep(name = "rules_java", version = "8.6.2")
bazel_dep(name = "rules_kotlin", version = "2.0.0-jb.5")
bazel_dep(name = "rules_graalvm", version = "0.11.3")
bazel_dep(name = "lib")
bazel_dep(name = "protobuf", version = "29.1")

# https://github.com/bazelbuild/bazel/issues/6681#issuecomment-2188972754
bazel_dep(name = "contrib_rules_jvm", version = "0.27.0")

http_file = use_repo_rule("@bazel_tools//tools/build_defs/repo:http.bzl", "http_file")

local_path_override(
    module_name = "lib",
    path = "../../lib",
)

# GraalVM
git_override(
    module_name = "rules_graalvm",
    remote = "https://github.com/develar/rules_graalvm",
    commit = "9d12232f7798df7087952314600f1ee0f4e4f9f7",
)

# local_path_override(
#   module_name = "rules_graalvm",
#   path = "../rules_graalvm",
# )
graalvm = use_extension("@rules_graalvm//:extensions.bzl", "graalvm")

graalvm.graalvm(
    name = "graalvm",
    distribution = "oracle",
    java_version = "23",
    version = "23.0.1",
)

use_repo(graalvm, "graalvm")
register_toolchains("@graalvm//:jvm")
register_toolchains("@graalvm//:sdk")
register_toolchains("@graalvm//:toolchain")

# Kotlin Rules
archive_override(
    module_name = "rules_kotlin",
    urls = ["https://github.com/develar/rules_kotlin/releases/download/v2.0.0-jb.12/rules_kotlin-v2.0.0-jb.12.tar.gz"],
    integrity = "sha256-jWDqcTgDWbeBqISkF4XFI/WbgeejFJVXMIDsv2oX/ww=",
)

# Libraries
http_jar = use_repo_rule("@bazel_tools//tools/build_defs/repo:http.bzl", "http_jar")

http_file(
    name = "kotlin-compiler_http",
    url = "https://repo1.maven.org/maven2/org/jetbrains/kotlin/kotlin-compiler/2.1.0/kotlin-compiler-2.1.0.jar",
    sha256 = "f6838d76c4a65da83e446ec7091b3f36195a90043010c67c79ddac0b3c8be08e",
    downloaded_file_path = "kotlin-compiler-2.1.0.jar",
)
http_file(
    name = "kotlin-compiler-sources_http",
    url = "https://repo1.maven.org/maven2/org/jetbrains/kotlin/kotlin-compiler/2.1.0/kotlin-compiler-2.1.0-sources.jar",
    sha256 = "dd966fb4fd739f810c5ddf780fadbb4117f2fd029253ba363306af2bf698f9e9",
    downloaded_file_path = "kotlin-compiler-2.1.0-sources.jar",
)

http_file(
    name = "kotlin-build-tools-impl_http",
    url = "https://repo1.maven.org/maven2/org/jetbrains/kotlin/kotlin-build-tools-impl/2.1.0/kotlin-build-tools-impl-2.1.0.jar",
    sha256 = "958827bc3711fc3c3491fc77f367a999ad558352b1a2b32d18f5916cce15ed39",
    downloaded_file_path = "kotlin-build-tools-impl-sources.jar",
)
http_file(
    name = "kotlin-build-tools-impl-sources_http",
    url = "https://repo1.maven.org/maven2/org/jetbrains/kotlin/kotlin-build-tools-impl/2.1.0/kotlin-build-tools-impl-2.1.0-sources.jar",
    sha256 = "631013f06b985934e113dc306fc1bf01b9686c0453de475b553714b25c66fe02",
    downloaded_file_path = "kotlin-build-tools-impl-2.1.0-sources.jar",
)

http_file(
    name = "kotlin-metadata-jvm_http",
    url = "https://repo1.maven.org/maven2/org/jetbrains/kotlin/kotlin-metadata-jvm/2.1.0/kotlin-metadata-jvm-2.1.0.jar",
    downloaded_file_path = "kotlin-metadata-jvm-2.1.0.jar",
    integrity = "sha256-uNOpJXS6HfxJvfIFJW0e3gZkFIyxUKti+qhyteG7RjI=",
)
http_file(
    name = "kotlin-metadata-jvm-sources_http",
    url = "https://repo1.maven.org/maven2/org/jetbrains/kotlin/kotlin-metadata-jvm/2.1.0/kotlin-metadata-jvm-2.1.0-sources.jar",
    downloaded_file_path = "kotlin-metadata-jvm-2.1.0-sources.jar",
    integrity = "sha256-L8es+9WcPIu4fPyGXOelQcwupXtj9W7AZ4SzLBtXLvQ=",
)

http_file(
    name = "protobuf-java-file",
    url = "https://cache-redirector.jetbrains.com/repo1.maven.org/maven2/com/google/protobuf/protobuf-java/4.29.1/protobuf-java-4.29.1.jar",
    sha256 = "c7dc027ca23bca4d56a330c8048e4829d0d9631e745a64fde4d49c3a9341e68b",
    downloaded_file_path = "protobuf-java-4.29.1.jar",
)
http_file(
    name = "protobuf-java-util-file",
    url = "https://cache-redirector.jetbrains.com/repo1.maven.org/maven2/com/google/protobuf/protobuf-java-util/4.29.1/protobuf-java-util-4.29.1.jar",
    sha256 = "77862bfb6486a344beb7f369a541180bab0abbe833519765777a8b14d296b9c1",
    downloaded_file_path = "protobuf-java-util-4.29.1.jar",
)

# Test Libraries

http_jar(
    name = "junit_jupiter_api",
    url = "https://repo1.maven.org/maven2/org/junit/jupiter/junit-jupiter-api/5.11.3/junit-jupiter-api-5.11.3.jar",
    integrity = "sha256-XYFHpg9JRTlz4lDtaHAbf/BVlk/iRi/Cyx7B1tRIibo=",
)

http_jar(
    name = "junit_jupiter_engine",
    url = "https://repo1.maven.org/maven2/org/junit/jupiter/junit-jupiter-engine/5.11.3/junit-jupiter-engine-5.11.3.jar",
    integrity = "sha256-5iQgyZ98DVmiFZou9j5hh36cgL1yLAPKi/O9zqBQpYk=",
)

http_jar(
    name = "junit_platform_engine",
    url = "https://repo1.maven.org/maven2/org/junit/platform/junit-platform-engine/1.11.3/junit-platform-engine-1.11.3.jar",
    integrity = "sha256-AEP3L2EWZHNdqNyaMIvxLs0iNrBTOTUcR0HttNj6sNo=",
)

http_jar(
    name = "junit_platform_reporting",
    url = "https://repo1.maven.org/maven2/org/junit/platform/junit-platform-reporting/1.11.3/junit-platform-reporting-1.11.3.jar",
    integrity = "sha256-uOGdvryufR/zC512cEf782lAJ8M9+kI7NxaTt/ZnntE=",
)

http_jar(
    name = "junit_platform_launcher",
    url = "https://repo1.maven.org/maven2/org/junit/platform/junit-platform-launcher/1.11.3/junit-platform-launcher-1.11.3.jar",
    integrity = "sha256-tHJ0WSAbABG+sHQr2AdCGh/IQmsRYZMDHth4JbwtTwQ=",
)

http_jar(
    name = "junit_platform_commons",
    url = "https://repo1.maven.org/maven2/org/junit/platform/junit-platform-commons/1.11.3/junit-platform-commons-1.11.3.jar",
    integrity = "sha256-viYpZLC2tI3pd8YdT5Md+M9h6A51DMPzoKOc3SHBAIw=",
)

http_jar(
    name = "assertj",
    url = "https://repo1.maven.org/maven2/org/assertj/assertj-core/3.26.3/assertj-core-3.26.3.jar",
    integrity = "sha256-TC+GQY/0fua2f7xq2xlOgCGbeTKBs72ih5nUQlvJoL0=",
)

http_jar(
    name = "opentest4j",
    url = "https://repo1.maven.org/maven2/org/opentest4j/opentest4j/1.3.0/opentest4j-1.3.0.jar",
    integrity = "sha256-SOLfY2yrZWPO1k3N/4q7I1VifLI27wvzdZhoLd90Lxs=",
)
