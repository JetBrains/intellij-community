<idea-plugin package="com.intellij.platform.ml.embeddings">
  <resource-bundle>messages.EmbeddingsBundle</resource-bundle>

  <extensions defaultExtensionNs="com.intellij">
    <notificationGroup id="Embedding-based search" displayType="STICKY_BALLOON"
                       bundle="messages.EmbeddingsBundle"
                       key="ml.embeddings.notification.group.name"/>

    <registryKey
      defaultValue="https://packages.jetbrains.team/maven/p/ml-search-everywhere/local-models/org/jetbrains/intellij/searcheverywhereMl/semantics/semantic-text-search/%MODEL_VERSION%/semantic-text-search-%MODEL_VERSION%.jar"
      description="Semantic search artifacts template link"
      key="intellij.platform.ml.embeddings.model.artifacts.link"/>

    <registryKey defaultValue="0.0.5"
                 description="Embeddings models version"
                 key="intellij.platform.ml.embeddings.model.version"/>

    <registryKey
      defaultValue="0.0.3"
      description="KInference model version"
      key="intellij.platform.ml.embeddings.ki.model.version"/>

    <registryKey defaultValue="2.0.140"
                 description="Embeddings native server version"
                 key="intellij.platform.ml.embeddings.server.version"/>

    <registryKey
      defaultValue="true"
      description="Use embedding indexing per-project files limit"
      key="intellij.platform.ml.embeddings.index.files.use.limit"/>

    <registryKey
      defaultValue="100000"
      description="Embedding indexing per-project files limit"
      key="intellij.platform.ml.embeddings.index.files.limit"/>

    <registryKey
      defaultValue="true"
      description="Use embedding indexing per-application memory limit"
      key="intellij.platform.ml.embeddings.index.use.memory.limit"/>

    <registryKey
      defaultValue="120"
      description="Embedding indexing per-application memory limit (MB)"
      key="intellij.platform.ml.embeddings.index.memory.limit"/>

    <registryKey
      defaultValue="false"
      description="Use native server for embeddings search and storage"
      key="intellij.platform.ml.embeddings.use.native.server"/>

    <statistics.counterUsagesCollector
      implementationClass="com.intellij.platform.ml.embeddings.logging.EmbeddingSearchLogger"/>
  </extensions>

  <extensionPoints>
    <extensionPoint
      qualifiedName="com.intellij.platform.ml.embeddings.indexPersistedEventsCounter"
      interface="com.intellij.platform.ml.embeddings.jvm.indices.IndexPersistedEventsCounter"
      dynamic="true"
      area="IDEA_PROJECT"/>

    <extensionPoint
      qualifiedName="com.intellij.platform.ml.embeddings.textEmbeddingsConfiguration"
      interface="com.intellij.platform.ml.embeddings.indexer.configuration.EmbeddingsConfiguration"
      dynamic="true"/>

    <extensionPoint name="embeddings.indexer.classesProvider" beanClass="com.intellij.openapi.fileTypes.FileTypeExtensionPoint" dynamic="true">
      <with attribute="implementationClass" implements="com.intellij.platform.ml.embeddings.indexer.ClassesProvider"/>
    </extensionPoint>
    <extensionPoint name="embeddings.indexer.symbolsProvider" beanClass="com.intellij.openapi.fileTypes.FileTypeExtensionPoint" dynamic="true">
      <with attribute="implementationClass" implements="com.intellij.platform.ml.embeddings.indexer.SymbolsProvider"/>
    </extensionPoint>
  </extensionPoints>

  <extensions defaultExtensionNs="com.intellij">
    <platform.ml.embeddings.textEmbeddingsConfiguration
      implementation="com.intellij.platform.ml.embeddings.indexer.configuration.InProcessEmbeddingsConfiguration"/>

    <platform.ml.embeddings.textEmbeddingsConfiguration
      implementation="com.intellij.platform.ml.embeddings.indexer.configuration.NativeServerEmbeddingsConfiguration"/>
  </extensions>

</idea-plugin>